---
title: "STA 198 Project"
author: "Julia Zinkin, Sydney Shankman, Christine Lee, Gabrielle Saft"
format: pdf
---


```{r}
#| echo: false
library(tidyverse)
library(ggplot2)
data <- read_csv("DonorHyperglycemia.csv")
```
**Introduction**

Liver transplantation has served as a life-saving intervention for individuals with end-stage chronic liver diseases. However, post-transplant outcomes vary due to donor and recipient factors. Donor hyperglycemia, in particular, has emerged as a potential contributor to graft vulnerability, the susceptibility of the transplanted liver to damage, yet the literature remains mixed and incomplete. Early studies examining critical care hyperglycemia demonstrated that elevated glucose can exacerbate oxidative stress, impair immune function, and worsen inflammatory cascades, mechanisms directly relevant to the ischemia–reperfusion injury experienced by liver grafts. Research in hepatic surgery and transplantation has shown that perioperative hyperglycemia is associated with higher rates of complications, including increased infections, impaired liver regeneration, and delayed normalization of liver enzymes.
Specific to liver transplantation, several donor-focused studies provide important background information. For example, Abraldes et al. (2010) found that donor diabetes and glucose dysregulation were associated with increased rates of early graft dysfunction, suggesting that pre-procurement metabolic instability may compromise the stability of liver cells. Mathur et al. (2017) similarly reported that donors with diabetes had higher rates of graft failure, though the mechanism, whether chronic hyperglycemia or associated comorbidities, remained unclear. More recent analyses, such as the 2023 study by Krishna et al., have shown that donor hyperglycemia correlates with increased inflammatory markers and worse early graft function, particularly when glucose variability is high. Other work has focused on the donor ICU course, where acute stress hyperglycemia has been associated with higher ALT/AST release, impaired microcirculation, and heightened susceptibility to reperfusion injury after procurement.

Beyond transplantation, evidence from broader surgical literature reinforces these concerns. Studies of postoperative hyperglycemics, such as the multicenter work published in Gastroenterología de México, have consistently demonstrated higher rates of infectious and metabolic complications in hyperglycemic patients, supporting the idea that elevated glucose levels contribute to systemic inflammatory dysregulation. Similarly, hepatobiliary surgical cohorts report worse outcomes when patients experience perioperative glucose spikes, lending biological plausibility to the hypothesis that donor hyperglycemia could negatively affect graft performance in recipients.
Together, these findings highlight a critical knowledge gap: despite growing evidence that hyperglycemia can impair hepatic cellular function and immune balance, the specific relationship between donor hyperglycemia and early post-transplant liver function remains unclear, with studies varying in definitions of hyperglycemia, outcome measures, and control for confounding donor characteristics.
Thus, this study seeks to address a central question: Among patients receiving a liver transplant, is donor hyperglycemia, by itself or in combination with other donor predictors, associated with impaired liver graft function in transplant recipients?
The dataset used in this analysis originates from a retrospective clinical study conducted at the Cleveland Clinic, examining whether hyperglycemia in deceased organ donors is associated with impaired liver graft function in transplant recipients. The data were collected from 591 orthotopic liver transplants performed between January 2005 and October 2010. Each observational unit corresponds to a single donor–recipient transplant pair, meaning every row represents one liver graft with linked donor characteristics, intraoperative variables, and recipient outcomes. Cases involving living donors, donors after cardiac death, or donors with fewer than two glucose measurements were excluded to ensure consistent and reliable estimates of donor glucose exposure.
Donor glucose data were extracted from routine clinical monitoring, and three measures of glycemic status were computed: the time-weighted average (TWA) glucose, the range of glucose observations, and the standard deviation of glucose observations. These metrics were used to capture both absolute hyperglycemia and glucose variability. Because donor glucose level could be tightly managed if doing so improved outcomes, it is important to understand whether they influence graft performance.
The primary outcome used in this project is delayed liver graft function, a binary variable indicating whether the graft demonstrated early dysfunction. In the original clinical definition, dysfunction included either primary nonfunction (death or retransplant within one week) or biochemical evidence of significant liver injury (AST > 2000 U/L or prothrombin time > 16 seconds between postoperative days 2–7).
In our analysis, we focus on TWA glucose (glutwa) as the primary predictor of interest and delayed graft function (delayed_fn) as the response variable. Additional donor-level variables available in the dataset include donor age, cause of death, race, sex, donor risk index, terminal sodium concentration, steatosis percentage, length of time systolic blood pressure was below 90 mmHg, and indicators of intraoperative hemodynamic instability. Recipient level variables in the dataset include age, weight, height, bmi, race, and sex. However, our central question is whether higher donor glucose levels are associated with an increased risk of delayed graft dysfunction.
Before modeling, exploratory data analysis was conducted to visualize the distributions of TWA glucose, range of glucose, standard deviation of glucose, and graft dysfunction rate. We then examined differences in glucose levels between grafts with and without delayed function using histograms and boxplots. Finally, we created two logistic regression models: a model examining the association between donor TWA glucose and delayed graft function, and a multivariable model that included glucose level, glucose variability metrics, and relevant donor and graft characteristics to assess whether hyperglycemia remained predictive after accounting for potential confounders.


##Exploratory Analysis

```{r}
#| echo: false
#| message: false
  ggplot(data = data, aes(x = glutwa)) +
      geom_histogram()  +
  labs(
    title = "Distribution of Time Weighted Average of Glucose in Liver Graft (GLUTWA) of Donors",
    x = "Time Weighted Average of Glucose in Liver Graft",
    y = "Count"
  )

```

```{r}
#| echo: false
#| message: false
  ggplot(data = data, aes(x = glurange)) +
      geom_histogram()  +
  labs(
    title = "Distribution of Range of Glucose in Liver Graft of Donors",
    x = "Range of Glucose in Liver Graft",
    y = "Count"
  )

```

```{r}
#| echo: false
#| message: false

  ggplot(data = data, aes(x = glusd)) +
      geom_histogram()  +
  labs(
    title = "Distribution of Standard Deviations of Glucose in Liver Graft of Donors",
    x = "Standard Deviations of Glucose in Liver Graft",
    y = "Count"
  )

```

```{r}
#| echo: false
ggplot(data, aes(x = factor(delayed_fn))) +
  geom_bar(fill = "blue") +
  scale_x_discrete(labels = c("No Graft Dysfunction", "Delayed Graft Dysfunction")) +
  labs(title = "Graft Dysfunction Rate",
       x = "Outcome",
       y = "Count")
```


```{r}
#| echo: false
data <- data |> 
  mutate(delayed_fn = factor(delayed_fn, labels = c("No Graft Dysfunction", "Graft Dysfunction")))
boxplot(glutwa ~ delayed_fn, data = data,
         main = "TWA of glucose obersrvations in liver graft vs delayed liver function",
         ylab = "Time weighted average of glucose obersrvations in liver graft")

```


```{r}
#| echo: false
ggplot(data, aes(x = glutwa, fill = delayed_fn)) +
  geom_histogram(alpha = 0.7, position = "identity", bins = 30) +
  labs(
    title = "Distribution of TWA Glucose by Graft Dysfunction Status",
    x = "TWA glucose (mg/dL)",
    y = "Count",
    fill = "Delayed liver graft function"
  ) +
  theme_bw() +
  theme(plot.title = element_text(size = 14, face = "bold"))

```



```{r}
#| echo: false
model_glutwa <- glm(delayed_fn ~ glutwa,
                    family = binomial,
                    data = data)
summary(model_glutwa)
plot(model_glutwa)
```

In this logistic regression model, donor time-weighted average glucose (TWA glucose) was not a statistically significant predictor of delayed liver graft dysfunction. The estimated coefficient for glutwa was 0.00298 (SE = 0.00172, p = 0.083), indicating that higher donor glucose levels were associated with slightly higher odds of delayed graft dysfunction. However, this association did not reach conventional levels of statistical significance at alpha = .05. Each 1 mg/dL increase in donor TWA glucose corresponds to an estimated 0.3% increase in the odds of delayed graft dysfunction (OR = exp(0.00298) = 1.003). This effect is very small in magnitude and the p-value suggests that the data do not provide strong evidence of a meaningful relationship.

```{r}
#| echo: false
model <- glm(
  delayed_fn ~ log2(glutwa) + log2(glurange) + log2(glusd) +
    d_age + r_bmi + r_age + cold_ischemia + sbp_lt_90 + hemo_instability + sodium + steatosis + donorrisk,
  data = data,
  family = binomial(link = "logit")
)

summary(model)

```
