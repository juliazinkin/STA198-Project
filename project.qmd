---
title: "STA 198 Project"
author: ""
format: pdf
---


```{r}
library(tidyverse)
library(ggplot2)
data <- read_csv("DonorHyperglycemia.csv")
```

###Exploratory Analysis

```{r}
  ggplot(data = data, aes(x = glutwa)) +
      geom_histogram()  +
  labs(
    title = "Distribution of Time Weighted Average of Glucose in Liver Graft (GLUTWA) of Donors",
    x = "Time Weighted Average of Glucose in Liver Graft",
    y = "Count"
  )

```

```{r}
  ggplot(data = data, aes(x = glurange)) +
      geom_histogram()  +
  labs(
    title = "Distribution of Range of Glucose in Liver Graft of Donors",
    x = "Range of Glucose in Liver Graft",
    y = "Count"
  )

```

```{r}
  ggplot(data = data, aes(x = glusd)) +
      geom_histogram()  +
  labs(
    title = "Distribution of Standard Deviations of Glucose in Liver Graft of Donors",
    x = "Standard Deviations of Glucose in Liver Graft",
    y = "Count"
  )

```


```{r}
data <- data |> 
  mutate(delayed_fn = factor(delayed_fn, labels = c("No Graft Dysfunction", "Graft Dysfunction")))
boxplot(glutwa ~ delayed_fn, data = data,
         main = "TWA of glucose obersrvations in liver graft vs delayed liver function",
         ylab = "Time weighted average of glucose obersrvations in liver graft")

```


```{r}
ggplot(data, aes(x = glutwa, fill = delayed_fn)) +
  geom_histogram(alpha = 0.7, position = "identity", bins = 30) +
  labs(
    title = "Distribution of TWA Glucose by Graft Dysfunction Status",
    x = "TWA glucose (mg/dL)",
    y = "Count",
    fill = "Delayed liver graft function"
  ) +
  theme_bw() +
  theme(plot.title = element_text(size = 14, face = "bold"))

```


```{r}
ggplot(data, aes(x = factor(delayed_fn))) +
  geom_bar(fill = "blue") +
  scale_x_discrete(labels = c("No Graft Dysfunction", "Delayed Graft Dysfunction")) +
  labs(title = "Graft Dysfunction Rate",
       x = "Outcome",
       y = "Count")
```

```{r}
model_glutwa <- glm(delayed_fn ~ glutwa,
                    family = binomial,
                    data = data)
summary(model_glutwa)
```
In this logistic regression model, donor time-weighted average glucose (TWA glucose) was not a statistically significant predictor of delayed liver graft dysfunction. The estimated coefficient for glutwa was 0.00298 (SE = 0.00172, p = 0.083), indicating that higher donor glucose levels were associated with slightly higher odds of delayed graft dysfunction. However, this association did not reach conventional levels of statistical significance at alpha = .05. Each 1 mg/dL increase in donor TWA glucose corresponds to an estimated 0.3% increase in the odds of delayed graft dysfunction (OR = exp(0.00298) = 1.003). This effect is very small in magnitude and the p-value suggests that the data do not provide strong evidence of a meaningful relationship.
